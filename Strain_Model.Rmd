---
title: "Strain_ABM"
author: "Rebecca"
date: "3 maj 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
pacman::p_load(pacman, tidyverse)

# This is a temporary version of the Work() function, which should simulate the agents working and opdate their effort, reward and strain values. 

# 0nly needs to be defined for the first loop
#----
agent_frame <- tibble("agent" = 1:3, "sucess" = 0, "effort" = 1, "reward" = 1, "mental_health" = reward/effort)
project_specs <- 0
model_specs <- 2

#SpecScheck()
#----
diff <- abs(project_specs - model_specs)
if(diff >= 4){
  agent_frame$reward <- agent_frame$reward - 4
}

#Work()
#---- 
s_prob <- 0.5*agent_frame[1,5]
colab <- sample(c("sucess", "fail"), 1, prob = c(s_prob,(1-s_prob)))

if(colab == "sucess"){
  agent_frame[1,2] <- agent_frame[1,2] + 1
  agent_frame[1,3] <- agent_frame[1,3] + 1
  agent_frame[1,4] <- agent_frame[1,4] + 1
  agent_frame[1,4] <- agent_frame[1,4]/agent_frame[1,3]
} else {
 agent_frame[1,3] <- agent_frame[1,3] + 1 
 agent_frame[1,4] <- agent_frame[1,4]/agent_frame[1,3]
}


```



## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
